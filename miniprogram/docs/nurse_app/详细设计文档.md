# 记录员微信小程序详细设计文档

## 1. 页面设计

### 1.1 首页 Dashboard
- 功能：展示今日任务、待处理事项、快捷入口
- 元素：
  - 欢迎信息和记录员姓名
  - 今日服务安排列表
  - 待处理任务提醒
  - 快捷功能按钮（签到、紧急上报等）

### 1.2 服务管理页面
- 功能：查看和管理服务预约
- 元素：
  - 服务列表（按日期分类）
  - 服务详情查看
  - 服务状态更新（待服务、服务中、已完成）
  - 紧急情况上报按钮

### 1.3 健康数据录入页面
- 功能：录入和管理老人健康数据
- 元素：
  - 老人信息展示
  - 健康指标输入表单（血压、血糖、体温等）
  - 上传附件功能（检查报告照片等）
  - 保存和提交按钮

### 1.4 健康档案页面
- 功能：查看老人完整健康档案
- 元素：
  - 基本信息展示
  - 历史健康数据图表
  - 服务记录列表
  - 备注和特殊需求显示

### 1.5 请假申请页面
- 功能：提交和管理请假申请
- 元素：
  - 请假时间选择器
  - 请假原因输入框
  - 工作交接安排
  - 替代记录员选择
  - 提交和撤回功能

### 1.6 沟通记录页面
- 功能：记录和查看沟通历史
- 元素：
  - 通话记录列表
  - 消息对话界面
  - 紧急联系人列表
  - 新建沟通记录按钮

### 1.7 资质管理页面
- 功能：管理专业资质和能力认证
- 元素：
  - 资质证书列表
  - 证书上传功能
  - 培训记录展示
  - 能力评估参与入口

### 1.8 个人中心页面
- 功能：个人信息和系统设置
- 元素：
  - 个人基本信息
  - 修改密码功能
  - 系统设置选项
  - 离职申请入口

## 2. API接口设计

### 2.1 用户认证接口
```
POST /api/auth/login - 用户登录
POST /api/auth/logout - 用户登出
GET /api/auth/profile - 获取用户信息
PUT /api/auth/profile - 更新用户信息
```

### 2.2 服务管理接口
```
GET /api/appointments - 获取服务预约列表
GET /api/appointments/{id} - 获取服务详情
PUT /api/appointments/{id}/status - 更新服务状态
POST /api/appointments/{id}/emergency - 紧急情况上报
```

### 2.3 健康数据接口
```
GET /api/health-records - 获取健康记录列表
POST /api/health-records - 创建健康记录
GET /api/health-records/{id} - 获取健康记录详情
PUT /api/health-records/{id} - 更新健康记录
```

### 2.4 请假管理接口
```
GET /api/leave-applications - 获取请假申请列表
POST /api/leave-applications - 创建请假申请
GET /api/leave-applications/{id} - 获取请假申请详情
PUT /api/leave-applications/{id} - 更新请假申请
```

### 2.5 沟通记录接口
```
GET /api/communications - 获取沟通记录列表
POST /api/communications - 创建沟通记录
GET /api/communications/{id} - 获取沟通记录详情
```

### 2.6 资质管理接口
```
GET /api/certifications - 获取资质列表
POST /api/certifications - 上传资质证书
GET /api/certifications/{id} - 获取资质详情
PUT /api/certifications/{id} - 更新资质信息
```

## 3. 数据库表设计

### 3.1 记录员表 (nurses)
```sql
CREATE TABLE nurses (
  id INT PRIMARY KEY AUTO_INCREMENT,
  user_id VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(100) NOT NULL,
  phone VARCHAR(20) NOT NULL,
  id_card VARCHAR(20),
  qualification TEXT,
  status ENUM('active', 'inactive', 'on_leave') DEFAULT 'active',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

### 3.2 服务预约表 (appointments)
```sql
CREATE TABLE appointments (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nurse_id INT NOT NULL,
  elder_id INT NOT NULL,
  service_type VARCHAR(100) NOT NULL,
  scheduled_time DATETIME NOT NULL,
  status ENUM('pending', 'in_progress', 'completed', 'cancelled') DEFAULT 'pending',
  notes TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (nurse_id) REFERENCES nurses(id)
);
```

### 3.3 健康记录表 (health_records)
```sql
CREATE TABLE health_records (
  id INT PRIMARY KEY AUTO_INCREMENT,
  elder_id INT NOT NULL,
  nurse_id INT NOT NULL,
  type VARCHAR(50) NOT NULL,
  value VARCHAR(100) NOT NULL,
  unit VARCHAR(20),
  recorded_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  notes TEXT,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (nurse_id) REFERENCES nurses(id)
);
```

### 3.4 请假申请表 (leave_applications)
```sql
CREATE TABLE leave_applications (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nurse_id INT NOT NULL,
  start_date DATE NOT NULL,
  end_date DATE NOT NULL,
  reason TEXT NOT NULL,
  replacement_nurse_id INT,
  status ENUM('pending', 'approved', 'rejected', 'cancelled') DEFAULT 'pending',
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (nurse_id) REFERENCES nurses(id),
  FOREIGN KEY (replacement_nurse_id) REFERENCES nurses(id)
);
```

### 3.5 沟通记录表 (communications)
```sql
CREATE TABLE communications (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nurse_id INT NOT NULL,
  elder_id INT NOT NULL,
  type ENUM('call', 'message', 'visit') NOT NULL,
  content TEXT NOT NULL,
  recorded_at DATETIME DEFAULT CURRENT_TIMESTAMP,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (nurse_id) REFERENCES nurses(id)
);
```

### 3.6 资质认证表 (certifications)
```sql
CREATE TABLE certifications (
  id INT PRIMARY KEY AUTO_INCREMENT,
  nurse_id INT NOT NULL,
  certificate_name VARCHAR(100) NOT NULL,
  certificate_number VARCHAR(100),
  issue_date DATE,
  expiry_date DATE,
  issuing_authority VARCHAR(100),
  status ENUM('valid', 'expired', 'pending') DEFAULT 'valid',
  file_path VARCHAR(255),
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (nurse_id) REFERENCES nurses(id)
);
```

## 4. 业务流程设计

### 4.1 服务执行流程
1. 记录员查看今日服务安排
2. 到达老人家中进行签到
3. 执行健康检查并录入数据
4. 更新服务状态为"服务中"
5. 完成服务后更新状态为"已完成"
6. 记录服务过程和沟通内容

### 4.2 请假申请流程
1. 记录员填写请假申请表单
2. 选择请假时间和原因
3. 安排工作交接和替代人员
4. 提交请假申请等待审批
5. 审批通过后系统自动分配替代人员
6. 请假结束后返岗确认

### 4.3 紧急情况处理流程
1. 记录员发现紧急情况
2. 立即通过小程序上报紧急情况
3. 系统自动通知相关管理人员和家属
4. 记录员按照应急预案处理
5. 详细记录紧急情况处理过程
6. 后续跟进和报告提交