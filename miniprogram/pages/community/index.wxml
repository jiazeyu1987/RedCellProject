<!-- ç¤¾åŒºäº’åŠ¨é¡µé¢ -->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <view class="top-nav">
    <view class="nav-item {{activeTab === 'posts' ? 'active' : ''}}" bindtap="switchTab" data-tab="posts">
      <text>åŠ¨æ€</text>
    </view>
    <view class="nav-item {{activeTab === 'knowledge' ? 'active' : ''}}" bindtap="switchTab" data-tab="knowledge">
      <text>å¥åº·çŸ¥è¯†</text>
    </view>
    <view class="nav-item {{activeTab === 'qa' ? 'active' : ''}}" bindtap="switchTab" data-tab="qa">
      <text>é—®ç­”</text>
    </view>
  </view>

  <!-- å‘å¸ƒæŒ‰é’® -->
  <view class="publish-btn" bindtap="publish">
    <text class="plus-icon">+</text>
  </view>

  <!-- å†…å®¹åŒºåŸŸ -->
  <view class="content-area">
    <!-- ç”¨æˆ·åŠ¨æ€ -->
    <view class="posts-content" wx:if="{{activeTab === 'posts'}}">
      <view class="post-item" wx:for="{{postList}}" wx:key="id" bindtap="viewPost" data-post="{{item}}">
        <view class="post-header">
          <text class="user-avatar">{{item.userAvatar}}</text>
          <view class="user-info">
            <text class="user-name">{{item.userName}}</text>
            <text class="post-time">{{item.createTime}}</text>
          </view>
        </view>
        <text class="post-content">{{item.content}}</text>
        <view class="post-images" wx:if="{{item.images && item.images.length > 0}}">
          <text class="post-image" wx:for="{{item.images}}" wx:for-item="img" wx:key="index" 
                 bindtap="previewImage" data-urls="{{item.images}}" data-current="{{img}}">{{img}}</text>
        </view>
        <view class="post-actions">
          <view class="action-item" bindtap="likePost" data-id="{{item.id}}">
            <text class="action-icon">â™¡</text>
            <text class="action-text">{{item.likes}}</text>
          </view>
          <view class="action-item" bindtap="commentPost" data-id="{{item.id}}">
            <text class="action-icon">ğŸ’¬</text>
            <text class="action-text">{{item.comments}}</text>
          </view>
          <view class="action-item">
            <text class="action-icon">ğŸ”—</text>
            <text class="action-text">åˆ†äº«</text>
          </view>
        </view>
      </view>
    </view>

    <!-- å¥åº·çŸ¥è¯† -->
    <view class="knowledge-content" wx:if="{{activeTab === 'knowledge'}}">
      <view class="knowledge-item" wx:for="{{knowledgeList}}" wx:key="id" bindtap="viewKnowledge" data-item="{{item}}">
        <text class="knowledge-cover">{{item.cover}}</text>
        <view class="knowledge-info">
          <text class="knowledge-title">{{item.title}}</text>
          <text class="knowledge-summary">{{item.summary}}</text>
          <view class="knowledge-meta">
            <text class="author">{{item.author}}</text>
            <text class="read-count">{{item.readCount}}äººé˜…è¯»</text>
          </view>
        </view>
      </view>
    </view>

    <!-- é—®ç­”åŒºåŸŸ -->
    <view class="qa-content" wx:if="{{activeTab === 'qa'}}">
      <view class="qa-item" wx:for="{{qaList}}" wx:key="id" bindtap="viewQA" data-item="{{item}}">
        <view class="question">
          <text class="q-tag">Q</text>
          <text class="q-content">{{item.question}}</text>
        </view>
        <view class="answer" wx:if="{{item.answer}}">
          <text class="a-tag">A</text>
          <text class="a-content">{{item.answer}}</text>
          <text class="doctor-name">- {{item.doctorName}}</text>
        </view>
        <view class="qa-meta">
          <text class="qa-time">{{item.createTime}}</text>
          <text class="qa-status {{item.status}}">{{item.statusText}}</text>
        </view>
      </view>
    </view>
  </view>
</view>

<!-- å‘å¸ƒåŠ¨æ€å¼¹æ¡† -->
<view class="modal-overlay" wx:if="{{showPublishModal}}">
  <view class="publish-modal" catchtap="">
    <view class="modal-header">
      <text class="modal-title">å‘å¸ƒåŠ¨æ€</text>
    </view>
    
    <view class="modal-content">
      <!-- å†…å®¹è¾“å…¥ -->
      <view class="input-section">
        <textarea 
          class="content-input" 
          placeholder="åˆ†äº«ä½ çš„å¥åº·ç”Ÿæ´»..."
          value="{{publishContent}}"
          bindinput="onContentInput"
          maxlength="500"
          auto-height="{{true}}"
          cursor-spacing="10">
        </textarea>
        <text class="char-count">{{publishContent.length}}/500</text>
      </view>
      
      <!-- å›¾ç‰‡é€‰æ‹© -->
      <view class="image-section">
        <view class="image-list">
          <view class="image-item" wx:for="{{publishImages}}" wx:key="index">
            <image class="preview-image" src="{{item}}" mode="aspectFill"></image>
            <view class="remove-btn" bindtap="removeImage" data-index="{{index}}">Ã—</view>
          </view>
          <view class="add-image-btn" wx:if="{{publishImages.length < 9}}" bindtap="chooseImages">
            <text class="add-icon">+</text>
            <text class="add-text">æ·»åŠ å›¾ç‰‡</text>
          </view>
        </view>
      </view>
    </view>
    
    <view class="modal-actions">
      <button class="modal-btn secondary" bindtap="closePublishModal">å–æ¶ˆ</button>
      <button class="modal-btn primary" bindtap="submitPost">å‘å¸ƒ</button>
    </view>
  </view>
</view>

<!-- æé—®å’¨è¯¢å¼¹æ¡† -->
<view class="modal-overlay" wx:if="{{showQuestionModal}}">
  <view class="question-modal" catchtap="">
    <view class="modal-header">
      <text class="modal-title">æé—®å’¨è¯¢</text>
    </view>
    
    <view class="modal-content">
      <!-- é—®é¢˜è¾“å…¥ -->
      <view class="input-section">
        <textarea 
          class="content-input" 
          placeholder="è¯·æè¿°ä½ çš„å¥åº·é—®é¢˜ï¼ŒåŒ»ç”Ÿä¼šå°½å¿«ä¸ºä½ è§£ç­”..."
          value="{{questionContent}}"
          bindinput="onQuestionInput"
          maxlength="200"
          auto-height="{{true}}"
          cursor-spacing="10">
        </textarea>
        <text class="char-count">{{questionContent.length}}/200</text>
      </view>
      
      <!-- æç¤ºä¿¡æ¯ -->
      <view class="tips-section">
        <text class="tips-title">æé—®æç¤ºï¼š</text>
        <text class="tips-item">â€¢ è¯·å°½é‡è¯¦ç»†æè¿°ç—‡çŠ¶å’Œæƒ…å†µ</text>
        <text class="tips-item">â€¢ åŒ»ç”Ÿå°†åœ¨24å°æ—¶å†…å›å¤</text>
        <text class="tips-item">â€¢ ç´§æ€¥æƒ…å†µè¯·æ‹¨æ‰“120æˆ–ç›´æ¥å°±åŒ»</text>
      </view>
    </view>
    
    <view class="modal-actions">
      <button class="modal-btn secondary" bindtap="closeQuestionModal">å–æ¶ˆ</button>
      <button class="modal-btn primary" bindtap="submitQuestion">æäº¤</button>
    </view>
  </view>
</view>