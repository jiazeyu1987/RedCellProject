<!-- å¥åº·æŠ¥å‘Šé¡µé¢ -->
<view class="container">
  <!-- æŠ¥å‘Šåˆ—è¡¨ -->
  <view class="report-list" wx:if="{{!loading}}">
    <view class="report-item" wx:for="{{reportList}}" wx:key="id" bindtap="viewDetail" data-report="{{item}}">
      <view class="report-header">
        <view class="report-title">{{item.title}}</view>
        <view class="status-badge {{item.status}}">{{item.status === 'normal' ? 'æ­£å¸¸' : item.status === 'warning' ? 'æ³¨æ„' : 'å¼‚å¸¸'}}</view>
      </view>
      
      <view class="report-info">
        <view class="info-row">
          <text class="info-label">ğŸ“… æ£€æŸ¥æ—¥æœŸï¼š</text>
          <text class="info-value">{{item.date}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">ğŸ¥ æ£€æŸ¥æœºæ„ï¼š</text>
          <text class="info-value">{{item.hospital}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">ğŸ‘¨â€âš•ï¸ æ£€æŸ¥åŒ»ç”Ÿï¼š</text>
          <text class="info-value">{{item.doctor}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">ğŸ“‹ æ£€æŸ¥ç±»å‹ï¼š</text>
          <text class="info-value">{{item.type}}</text>
        </view>
      </view>

      <view class="report-summary">
        <text class="summary-text">{{item.summary}}</text>
      </view>

      <view class="report-actions">
        <button class="action-btn secondary" bindtap="downloadReport" data-id="{{item.id}}" catchtap="">ä¸‹è½½</button>
        <button class="action-btn secondary" bindtap="shareReport" data-report="{{item}}" catchtap="">åˆ†äº«</button>
        <button class="action-btn primary" bindtap="viewDetail" data-report="{{item}}" catchtap="">æŸ¥çœ‹è¯¦æƒ…</button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && reportList.length === 0}}">
    <text class="empty-icon">ğŸ“ˆ</text>
    <text class="empty-text">æš‚æ— å¥åº·æŠ¥å‘Š</text>
    <button class="empty-action" bindtap="goToHealth">å»ä½“æ£€</button>
  </view>
</view>

<!-- æŠ¥å‘Šè¯¦æƒ…å¼¹çª— -->
<view class="modal-overlay" wx:if="{{showDetailModal}}" bindtap="closeDetail">
  <view class="detail-modal" catchtap="">
    <view class="modal-header">
      <text class="modal-title">{{selectedReport.title}}</text>
      <text class="modal-close" bindtap="closeDetail">Ã—</text>
    </view>
    
    <view class="modal-content">
      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <view class="detail-section">
        <text class="section-title">åŸºæœ¬ä¿¡æ¯</text>
        <view class="detail-info">
          <view class="detail-row">
            <text class="detail-label">æ£€æŸ¥æ—¥æœŸï¼š</text>
            <text class="detail-value">{{selectedReport.date}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ£€æŸ¥ç±»å‹ï¼š</text>
            <text class="detail-value">{{selectedReport.type}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ£€æŸ¥åŒ»ç”Ÿï¼š</text>
            <text class="detail-value">{{selectedReport.doctor}}</text>
          </view>
          <view class="detail-row">
            <text class="detail-label">æ£€æŸ¥æœºæ„ï¼š</text>
            <text class="detail-value">{{selectedReport.hospital}}</text>
          </view>
        </view>
      </view>

      <!-- æ£€æŸ¥ç»“æœ -->
      <view class="detail-section" wx:if="{{selectedReport.details}}">
        <text class="section-title">æ£€æŸ¥ç»“æœ</text>
        <view class="metrics-list">
          <view class="metric-item" wx:for="{{selectedReport.details}}" wx:key="name" wx:for-item="metric">
            <view class="metric-header">
              <text class="metric-name">{{metric.name}}</text>
              <view class="metric-status {{metric.status}}">{{metric.status === 'normal' ? 'æ­£å¸¸' : metric.status === 'warning' ? 'æ³¨æ„' : 'å¼‚å¸¸'}}</view>
            </view>
            <view class="metric-value">
              <text class="value">{{metric.value}}</text>
              <text class="unit">{{metric.unit}}</text>
            </view>
            <text class="metric-reference">å‚è€ƒèŒƒå›´ï¼š{{metric.reference}}</text>
          </view>
        </view>
      </view>

      <!-- å¥åº·å»ºè®® -->
      <view class="detail-section" wx:if="{{selectedReport.recommendations}}">
        <text class="section-title">å¥åº·å»ºè®®</text>
        <view class="recommendations">
          <view class="recommendation-item" wx:for="{{selectedReport.recommendations}}" wx:key="index">
            <text class="recommendation-text">{{index + 1}}. {{item}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <view class="modal-actions">
      <button class="modal-btn secondary" bindtap="downloadReport" data-id="{{selectedReport.id}}">ä¸‹è½½æŠ¥å‘Š</button>
      <button class="modal-btn primary" bindtap="shareReport" data-report="{{selectedReport}}">åˆ†äº«æŠ¥å‘Š</button>
    </view>
  </view>
</view>