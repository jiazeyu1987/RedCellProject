# 健康守护小程序 - 功能模块说明文档

## 项目概述

健康守护小程序是一款面向居家养老服务的微信小程序，提供上门医疗服务预约、健康数据管理、社区互动等功能。

## 功能模块架构

### 1. 用户端功能模块

#### 1.1 首页模块 (pages/home)
**功能描述**: 应用首页，展示服务概览和快捷入口

**主要功能**:
- 服务轮播图展示
- 快速预约入口
- 服务类型展示
- 最新动态显示
- 紧急联系方式

**页面文件**:
- `index.js` - 页面逻辑
- `index.wxml` - 页面结构  
- `index.wxss` - 页面样式
- `index.json` - 页面配置

#### 1.2 服务预约模块 (pages/booking)
**功能描述**: 服务预约功能，支持选择服务类型、时间和地址

**主要功能**:
- 服务类型选择
- 预约时间选择
- 服务地址管理
- 预约信息确认
- 预约状态跟踪

**相关页面**:
- `pages/booking/index.*` - 预约主页面
- `pages/booking-history/index.*` - 预约历史
- `pages/address-management/index.*` - 地址管理

#### 1.3 健康档案模块 (pages/health)
**功能描述**: 个人健康数据管理和健康报告查看

**主要功能**:
- 健康数据录入（血压、血糖、体温等）
- 健康趋势图表展示
- 健康报告生成
- 健康提醒设置
- 数据导出功能

**相关页面**:
- `pages/health/index.*` - 健康首页
- `pages/health-report/index.*` - 健康报告
- `pages/health-plan/index.*` - 健康计划

#### 1.4 社区互动模块 (pages/community)
**功能描述**: 用户社区交流平台

**主要功能**:
- 健康知识分享
- 用户经验交流
- 问题咨询互助
- 动态点赞评论
- 话题讨论

**页面文件**:
- `pages/community/index.*` - 社区首页

#### 1.5 个人中心模块 (pages/profile)
**功能描述**: 用户个人信息管理和应用设置

**主要功能**:
- 个人信息展示
- 服务记录查看
- 家庭成员管理
- 应用设置
- 意见反馈
- 隐藏管理员入口

**相关页面**:
- `pages/profile/index.*` - 个人中心
- `pages/service-record/index.*` - 服务记录
- `pages/family-members/index.*` - 家庭成员
- `pages/settings/index.*` - 设置
- `pages/feedback/index.*` - 意见反馈
- `pages/help/index.*` - 帮助中心
- `pages/about/index.*` - 关于我们

#### 1.6 医院挂号模块 (pages/hospital)
**功能描述**: 在线医院挂号预约服务

**主要功能**:
- 医院列表查看
- 科室医生查询
- 在线挂号预约
- 挂号记录管理

**页面文件**:
- `pages/hospital/index.*` - 医院挂号

### 2. 管理员功能模块

#### 2.1 管理员登录模块 (pages/admin-login)
**功能描述**: 管理员身份验证

**主要功能**:
- 口令验证登录
- 登录状态管理（30分钟有效期）
- 密码显示/隐藏切换
- 安全提示信息

**验证口令**:
- `admin123`
- `health2024`
- `manager888`

#### 2.2 用户管理模块 (pages/admin-users)
**功能描述**: 管理员查看和管理所有用户信息

**主要功能**:
- 用户列表展示
- 用户搜索功能
- 用户状态筛选
- 用户数据排序
- 用户详情查看
- 数据导出功能
- 管理员退出

#### 2.3 用户详情模块 (pages/admin-user-detail)
**功能描述**: 查看单个用户的详细信息

**主要功能**:
- 基本信息查看
- 敏感信息权限控制
- 地址历史记录
- 服务记录详情
- 健康档案查看
- 用户操作管理（冻结等）

### 3. 通用组件模块

#### 3.1 服务卡片组件 (components/service-card)
**功能描述**: 展示服务信息的卡片组件

**使用场景**:
- 首页服务展示
- 预约页面服务选择

#### 3.2 加载组件 (components/loading)
**功能描述**: 数据加载时的等待提示

**使用场景**:
- 页面数据加载
- 操作处理等待

#### 3.3 认证守卫组件 (components/auth-guard)
**功能描述**: 用户登录状态检查

**使用场景**:
- 需要登录的页面保护
- 用户权限验证

#### 3.4 健康指标卡片 (components/health-metric-card)
**功能描述**: 健康数据展示卡片

**使用场景**:
- 健康档案页面
- 健康报告展示

#### 3.5 空状态组件 (components/empty-state)
**功能描述**: 数据为空时的提示界面

**使用场景**:
- 列表数据为空
- 搜索无结果

## 数据流设计

### 1. 全局数据管理 (app.js)

```javascript
globalData: {
  // 用户信息
  userInfo: null,
  openId: null,
  isLoggedIn: false,
  
  // 服务配置
  serviceTypes: [...],
  hospitals: [...],
  
  // 管理员配置
  adminConfig: {
    passwords: ['admin123', 'health2024', 'manager888'],
    permissions: {...}
  },
  
  // 模拟用户数据
  mockUsers: [...]
}
```

### 2. 数据管理方法

```javascript
// 用户相关
login(userInfo, openId)
logout()
checkLoginStatus()

// 管理员相关
verifyAdminPassword(password)
getAllUsers()
getUserById(userId)
setAdminLoginStatus(status)
checkAdminLoginExpiry()

// 业务逻辑
searchUsers(keyword)
filterUsersByStatus(status)
sortUsers(users, sortBy, order)
getUserAddressHistory(userId)
getUserServiceHistory(userId)
```

## 页面路由结构

```
首页 (pages/home/index)
├── 服务预约 (pages/booking/index)
│   ├── 预约历史 (pages/booking-history/index)
│   └── 地址管理 (pages/address-management/index)
├── 健康档案 (pages/health/index)
│   ├── 健康报告 (pages/health-report/index)
│   └── 健康计划 (pages/health-plan/index)
├── 社区互动 (pages/community/index)
├── 个人中心 (pages/profile/index)
│   ├── 服务记录 (pages/service-record/index)
│   ├── 家庭成员 (pages/family-members/index)
│   ├── 设置 (pages/settings/index)
│   ├── 意见反馈 (pages/feedback/index)
│   ├── 帮助中心 (pages/help/index)
│   ├── 关于我们 (pages/about/index)
│   └── 管理员入口 (pages/admin-login/index)
│       ├── 用户管理 (pages/admin-users/index)
│       └── 用户详情 (pages/admin-user-detail/index)
└── 医院挂号 (pages/hospital/index)
```

## 权限控制设计

### 1. 用户端权限
- 游客权限：浏览首页、社区内容
- 登录用户：完整功能访问
- VIP用户：专属服务优先

### 2. 管理员权限
- 基础权限：查看用户基本信息
- 敏感信息权限：查看完整手机号、身份证
- 操作权限：冻结用户、导出数据
- 登录时效：30分钟自动过期

### 3. 权限验证流程
```javascript
// 用户权限检查
if (!app.globalData.isLoggedIn) {
  // 跳转登录页面
}

// 管理员权限检查
if (!app.checkAdminLoginExpiry()) {
  // 跳转管理员登录
}

// 敏感信息权限
if (!app.checkAdminPermission('viewSensitiveInfo')) {
  // 权限不足提示
}
```

## 数据模拟设计

### 1. 用户数据结构
```javascript
{
  id: 'user_001',
  nickname: '张医生',
  realName: '张明华',
  phone: '138****5678', // 脱敏显示
  fullPhone: '13812345678', // 完整信息
  memberLevel: 'vip',
  serviceCount: 15,
  totalSpent: 2500,
  healthCondition: '良好',
  allergies: '青霉素过敏',
  // ... 其他字段
}
```

### 2. 服务记录数据
```javascript
{
  id: 'service_001',
  serviceName: '基础健康监测',
  serviceTime: '2025-08-20 14:00',
  nurse: '护士小王',
  cost: 100,
  rating: 5,
  feedback: '服务很专业...'
}
```

### 3. 地址历史数据
```javascript
{
  id: 'addr_001',
  address: '深圳市南山区...',
  contactName: '张明华',
  isDefault: true,
  visitCount: 8,
  lastVisit: '2025-08-20'
}
```

## 样式设计规范

### 1. 主题颜色
- 主色调：#1890FF（蓝色）
- 辅助色：#40A9FF（浅蓝）
- 成功色：#52C41A（绿色）
- 警告色：#FAAD14（橙色）
- 危险色：#FF4D4F（红色）

### 2. 间距规范
- 页面边距：20rpx
- 卡片间距：15rpx
- 内容边距：30rpx
- 按钮圆角：15rpx

### 3. 字体规范
- 标题：36rpx, bold
- 副标题：28rpx, normal
- 正文：26rpx, normal
- 辅助文字：22rpx, normal

## 性能优化策略

### 1. 代码层面
- 使用组件化开发
- 合理使用setData
- 图片懒加载
- 分包加载

### 2. 数据层面
- 本地缓存用户信息
- 分页加载列表数据
- 防抖搜索处理

### 3. 体验层面
- 加载状态提示
- 骨架屏展示
- 错误边界处理

---

**文档版本**: v1.0  
**创建时间**: 2025-08-25  
**维护人员**: 前端开发团队