<view wx:if="{{visible}}" class="schedule-filter {{customClass}}">
  <!-- é®ç½©å±‚ -->
  <view class="filter-mask" bindtap="hide"></view>
  
  <!-- ç­›é€‰å™¨ä¸»ä½“ -->
  <view class="filter-container">
    <!-- å¤´éƒ¨ -->
    <view class="filter-header">
      <view class="header-title">ç­›é€‰æ¡ä»¶</view>
      <view class="header-actions">
        <text class="reset-btn" bindtap="resetFilters">é‡ç½®</text>
        <text class="close-btn" bindtap="hide">âœ•</text>
      </view>
    </view>

    <!-- å¿«é€Ÿç­›é€‰ -->
    <view class="quick-filters">
      <view class="section-title">å¿«é€Ÿç­›é€‰</view>
      <view class="quick-filter-list">
        <view class="quick-filter-item" data-type="today_pending" bindtap="quickFilter">
          <text class="quick-icon">ğŸ“</text>
          <text class="quick-text">ä»Šæ—¥å¾…æœåŠ¡</text>
        </view>
        <view class="quick-filter-item" data-type="urgent_all" bindtap="quickFilter">
          <text class="quick-icon">ğŸ”¥</text>
          <text class="quick-text">ç´§æ€¥æœåŠ¡</text>
        </view>
        <view class="quick-filter-item" data-type="overdue" bindtap="quickFilter">
          <text class="quick-icon">âš ï¸</text>
          <text class="quick-text">å·²è¿‡æœŸ</text>
        </view>
        <view class="quick-filter-item" data-type="emergency" bindtap="quickFilter">
          <text class="quick-icon">ğŸš¨</text>
          <text class="quick-text">ç´§æ€¥ç±»å‹</text>
        </view>
      </view>
    </view>

    <!-- æœç´¢æ  -->
    <view class="search-section">
      <view class="section-title">æœç´¢</view>
      <view class="search-input-container">
        <input 
          class="search-input"
          placeholder="æœç´¢æ‚£è€…å§“åã€åœ°å€ã€å¤‡æ³¨..."
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
          bindconfirm="onSearchConfirm"
        />
        <view wx:if="{{searchKeyword}}" class="clear-search" bindtap="clearSearch">âœ•</view>
      </view>
    </view>

    <!-- ç­›é€‰é€‰é¡¹ -->
    <view class="filter-sections">
      
      <!-- æ—¶é—´ç­›é€‰ -->
      <view class="filter-section">
        <view class="filter-tab {{activePanel === 'time' ? 'active' : ''}}" 
              data-panel="time" bindtap="togglePanel">
          <text class="tab-icon">ğŸ“…</text>
          <text class="tab-text">æ—¶é—´</text>
          <text class="tab-value">{{activeFilters.time === 'all' ? 'å…¨éƒ¨' : activeFilters.time}}</text>
          <text class="tab-arrow">{{activePanel === 'time' ? 'â–¼' : 'â–¶'}}</text>
        </view>
        
        <view wx:if="{{activePanel === 'time'}}" class="filter-options">
          <view wx:for="{{filterOptions.timeFilters}}" wx:key="key"
                class="filter-option {{activeFilters.time === item.key ? 'selected' : ''}}"
                data-type="time" data-value="{{item.key}}"
                bindtap="selectFilter">
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-text">{{item.label}}</text>
            <text wx:if="{{activeFilters.time === item.key}}" class="option-check">âœ“</text>
          </view>
          
          <!-- è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´ -->
          <view class="custom-date-range">
            <view class="date-range-title">è‡ªå®šä¹‰æ—¥æœŸèŒƒå›´</view>
            <view class="date-range-inputs">
              <picker mode="date" 
                      value="{{customDateRange.startDate}}"
                      data-type="startDate"
                      bindchange="onCustomDateChange">
                <view class="date-input">
                  {{customDateRange.startDate || 'å¼€å§‹æ—¥æœŸ'}}
                </view>
              </picker>
              <text class="date-separator">è‡³</text>
              <picker mode="date" 
                      value="{{customDateRange.endDate}}"
                      data-type="endDate"
                      bindchange="onCustomDateChange">
                <view class="date-input">
                  {{customDateRange.endDate || 'ç»“æŸæ—¥æœŸ'}}
                </view>
              </picker>
            </view>
          </view>
        </view>
      </view>

      <!-- çŠ¶æ€ç­›é€‰ -->
      <view class="filter-section">
        <view class="filter-tab {{activePanel === 'status' ? 'active' : ''}}" 
              data-panel="status" bindtap="togglePanel">
          <text class="tab-icon">ğŸ”„</text>
          <text class="tab-text">çŠ¶æ€</text>
          <text class="tab-value">{{activeFilters.status === 'all' ? 'å…¨éƒ¨' : activeFilters.status}}</text>
          <text class="tab-arrow">{{activePanel === 'status' ? 'â–¼' : 'â–¶'}}</text>
        </view>
        
        <view wx:if="{{activePanel === 'status'}}" class="filter-options">
          <view wx:for="{{filterOptions.statusFilters}}" wx:key="key"
                class="filter-option {{activeFilters.status === item.key ? 'selected' : ''}}"
                data-type="status" data-value="{{item.key}}"
                bindtap="selectFilter">
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-text">{{item.label}}</text>
            <text wx:if="{{activeFilters.status === item.key}}" class="option-check">âœ“</text>
          </view>
        </view>
      </view>

      <!-- ç±»å‹ç­›é€‰ -->
      <view class="filter-section">
        <view class="filter-tab {{activePanel === 'type' ? 'active' : ''}}" 
              data-panel="type" bindtap="togglePanel">
          <text class="tab-icon">ğŸ“‹</text>
          <text class="tab-text">ç±»å‹</text>
          <text class="tab-value">{{activeFilters.type === 'all' ? 'å…¨éƒ¨' : activeFilters.type}}</text>
          <text class="tab-arrow">{{activePanel === 'type' ? 'â–¼' : 'â–¶'}}</text>
        </view>
        
        <view wx:if="{{activePanel === 'type'}}" class="filter-options">
          <view wx:for="{{filterOptions.typeFilters}}" wx:key="key"
                class="filter-option {{activeFilters.type === item.key ? 'selected' : ''}}"
                data-type="type" data-value="{{item.key}}"
                bindtap="selectFilter">
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-text">{{item.label}}</text>
            <text wx:if="{{activeFilters.type === item.key}}" class="option-check">âœ“</text>
          </view>
        </view>
      </view>

      <!-- ä¼˜å…ˆçº§ç­›é€‰ -->
      <view class="filter-section">
        <view class="filter-tab {{activePanel === 'priority' ? 'active' : ''}}" 
              data-panel="priority" bindtap="togglePanel">
          <text class="tab-icon">âš–ï¸</text>
          <text class="tab-text">ä¼˜å…ˆçº§</text>
          <text class="tab-value">{{activeFilters.priority === 'all' ? 'å…¨éƒ¨' : activeFilters.priority}}</text>
          <text class="tab-arrow">{{activePanel === 'priority' ? 'â–¼' : 'â–¶'}}</text>
        </view>
        
        <view wx:if="{{activePanel === 'priority'}}" class="filter-options">
          <view wx:for="{{filterOptions.priorityFilters}}" wx:key="key"
                class="filter-option {{activeFilters.priority === item.key ? 'selected' : ''}}"
                data-type="priority" data-value="{{item.key}}"
                bindtap="selectFilter">
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-text">{{item.label}}</text>
            <text wx:if="{{activeFilters.priority === item.key}}" class="option-check">âœ“</text>
          </view>
        </view>
      </view>

      <!-- æ’åºé€‰é¡¹ -->
      <view class="filter-section">
        <view class="filter-tab {{activePanel === 'sort' ? 'active' : ''}}" 
              data-panel="sort" bindtap="togglePanel">
          <text class="tab-icon">ğŸ”€</text>
          <text class="tab-text">æ’åº</text>
          <text class="tab-value">{{activeFilters.sort}}</text>
          <text class="tab-arrow">{{activePanel === 'sort' ? 'â–¼' : 'â–¶'}}</text>
        </view>
        
        <view wx:if="{{activePanel === 'sort'}}" class="filter-options">
          <view wx:for="{{filterOptions.sortOptions}}" wx:key="key"
                class="filter-option {{activeFilters.sort === item.key ? 'selected' : ''}}"
                data-type="sort" data-value="{{item.key}}"
                bindtap="selectFilter">
            <text class="option-icon">{{item.icon}}</text>
            <text class="option-text">{{item.label}}</text>
            <text wx:if="{{activeFilters.sort === item.key}}" class="option-check">âœ“</text>
          </view>
        </view>
      </view>

    </view>

    <!-- åº”ç”¨æŒ‰é’® -->
    <view class="filter-footer">
      <view class="apply-btn" bindtap="applyFilters">
        åº”ç”¨ç­›é€‰æ¡ä»¶
      </view>
    </view>
  </view>
</view>